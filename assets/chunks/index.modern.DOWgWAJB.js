function J(){return J=Object.assign||function(l){for(var t=1;t<arguments.length;t++){var c=arguments[t];for(var u in c)Object.prototype.hasOwnProperty.call(c,u)&&(l[u]=c[u])}return l},J.apply(this,arguments)}function X(l){var t={exports:{}};return l(t,t.exports),t.exports}var I=X(function(l,t){l.exports=function(){var c="millisecond",u="second",y="minute",d="hour",T="day",U="week",m="month",k="quarter",g="year",S="date",o=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,Y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},w=function(a,n,e){var i=String(a);return!i||i.length>=n?a:""+Array(n+1-i.length).join(e)+a},C={s:w,z:function(a){var n=-a.utcOffset(),e=Math.abs(n),i=Math.floor(e/60),r=e%60;return(n<=0?"+":"-")+w(i,2,"0")+":"+w(r,2,"0")},m:function a(n,e){if(n.date()<e.date())return-a(e,n);var i=12*(e.year()-n.year())+(e.month()-n.month()),r=n.clone().add(i,m),f=e-r<0,s=n.clone().add(i+(f?-1:1),m);return+(-(i+(e-r)/(f?r-s:s-r))||0)},a:function(a){return a<0?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:m,y:g,w:U,d:T,D:S,h:d,m:y,s:u,ms:c,Q:k}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return a===void 0}},L="en",x={};x[L]=_;var z=function(a){return a instanceof F},Z=function(a,n,e){var i;if(!a)return L;if(typeof a=="string")x[a]&&(i=a),n&&(x[a]=n,i=a);else{var r=a.name;x[r]=a,i=r}return!e&&i&&(L=i),i||!e&&L},v=function(a,n){if(z(a))return a.clone();var e=typeof n=="object"?n:{};return e.date=a,e.args=arguments,new F(e)},h=C;h.l=Z,h.i=z,h.w=function(a,n){return v(a,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var F=function(){function a(e){this.$L=Z(e.locale,null,!0),this.parse(e)}var n=a.prototype;return n.parse=function(e){this.$d=function(i){var r=i.date,f=i.utc;if(r===null)return new Date(NaN);if(h.u(r))return new Date;if(r instanceof Date)return new Date(r);if(typeof r=="string"&&!/Z$/i.test(r)){var s=r.match(o);if(s){var $=s[2]-1||0,p=(s[7]||"0").substring(0,3);return f?new Date(Date.UTC(s[1],$,s[3]||1,s[4]||0,s[5]||0,s[6]||0,p)):new Date(s[1],$,s[3]||1,s[4]||0,s[5]||0,s[6]||0,p)}}return new Date(r)}(e),this.$x=e.x||{},this.init()},n.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},n.$utils=function(){return h},n.isValid=function(){return this.$d.toString()!=="Invalid Date"},n.isSame=function(e,i){var r=v(e);return this.startOf(i)<=r&&r<=this.endOf(i)},n.isAfter=function(e,i){return v(e)<this.startOf(i)},n.isBefore=function(e,i){return this.endOf(i)<v(e)},n.$g=function(e,i,r){return h.u(e)?this[i]:this.set(r,e)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(e,i){var r=this,f=!!h.u(i)||i,s=h.p(e),$=function(j,O){var A=h.w(r.$u?Date.UTC(r.$y,O,j):new Date(r.$y,O,j),r);return f?A:A.endOf(T)},p=function(j,O){return h.w(r.toDate()[j].apply(r.toDate("s"),(f?[0,0,0,0]:[23,59,59,999]).slice(O)),r)},D=this.$W,M=this.$M,R=this.$D,b="set"+(this.$u?"UTC":"");switch(s){case g:return f?$(1,0):$(31,11);case m:return f?$(1,M):$(0,M+1);case U:var V=this.$locale().weekStart||0,W=(D<V?D+7:D)-V;return $(f?R-W:R+(6-W),M);case T:case S:return p(b+"Hours",0);case d:return p(b+"Minutes",1);case y:return p(b+"Seconds",2);case u:return p(b+"Milliseconds",3);default:return this.clone()}},n.endOf=function(e){return this.startOf(e,!1)},n.$set=function(e,i){var r,f=h.p(e),s="set"+(this.$u?"UTC":""),$=(r={},r[T]=s+"Date",r[S]=s+"Date",r[m]=s+"Month",r[g]=s+"FullYear",r[d]=s+"Hours",r[y]=s+"Minutes",r[u]=s+"Seconds",r[c]=s+"Milliseconds",r)[f],p=f===T?this.$D+(i-this.$W):i;if(f===m||f===g){var D=this.clone().set(S,1);D.$d[$](p),D.init(),this.$d=D.set(S,Math.min(this.$D,D.daysInMonth())).$d}else $&&this.$d[$](p);return this.init(),this},n.set=function(e,i){return this.clone().$set(e,i)},n.get=function(e){return this[h.p(e)]()},n.add=function(e,i){var r,f=this;e=Number(e);var s=h.p(i),$=function(M){var R=v(f);return h.w(R.date(R.date()+Math.round(M*e)),f)};if(s===m)return this.set(m,this.$M+e);if(s===g)return this.set(g,this.$y+e);if(s===T)return $(1);if(s===U)return $(7);var p=(r={},r[y]=6e4,r[d]=36e5,r[u]=1e3,r)[s]||1,D=this.$d.getTime()+e*p;return h.w(D,this)},n.subtract=function(e,i){return this.add(-1*e,i)},n.format=function(e){var i=this;if(!this.isValid())return"Invalid Date";var r=e||"YYYY-MM-DDTHH:mm:ssZ",f=h.z(this),s=this.$locale(),$=this.$H,p=this.$m,D=this.$M,M=s.weekdays,R=s.months,b=function(O,A,G,P){return O&&(O[A]||O(i,r))||G[A].substr(0,P)},V=function(O){return h.s($%12||12,O,"0")},W=s.meridiem||function(O,A,G){var P=O<12?"AM":"PM";return G?P.toLowerCase():P},j={YY:String(this.$y).slice(-2),YYYY:this.$y,M:D+1,MM:h.s(D+1,2,"0"),MMM:b(s.monthsShort,D,R,3),MMMM:b(R,D),D:this.$D,DD:h.s(this.$D,2,"0"),d:String(this.$W),dd:b(s.weekdaysMin,this.$W,M,2),ddd:b(s.weekdaysShort,this.$W,M,3),dddd:M[this.$W],H:String($),HH:h.s($,2,"0"),h:V(1),hh:V(2),a:W($,p,!0),A:W($,p,!1),m:String(p),mm:h.s(p,2,"0"),s:String(this.$s),ss:h.s(this.$s,2,"0"),SSS:h.s(this.$ms,3,"0"),Z:f};return r.replace(Y,function(O,A){return A||j[O]||f.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(e,i,r){var f,s=h.p(i),$=v(e),p=6e4*($.utcOffset()-this.utcOffset()),D=this-$,M=h.m(this,$);return M=(f={},f[g]=M/12,f[m]=M,f[k]=M/3,f[U]=(D-p)/6048e5,f[T]=(D-p)/864e5,f[d]=D/36e5,f[y]=D/6e4,f[u]=D/1e3,f)[s]||D,r?M:h.a(M)},n.daysInMonth=function(){return this.endOf(m).$D},n.$locale=function(){return x[this.$L]},n.locale=function(e,i){if(!e)return this.$L;var r=this.clone(),f=Z(e,i,!0);return f&&(r.$L=f),r},n.clone=function(){return h.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},a}(),B=F.prototype;return v.prototype=B,[["$ms",c],["$s",u],["$m",y],["$H",d],["$W",T],["$M",m],["$y",g],["$D",S]].forEach(function(a){B[a[1]]=function(n){return this.$g(n,a[0],a[1])}}),v.extend=function(a,n){return a.$i||(a(n,F,v),a.$i=!0),v},v.locale=Z,v.isDayjs=z,v.unix=function(a){return v(1e3*a)},v.en=x[L],v.Ls=x,v.p={},v}()}),Q=X(function(l,t){l.exports=function(c,u,y){var d=u.prototype;y.utc=function(o){return new u({date:o,utc:!0,args:arguments})},d.utc=function(o){var Y=y(this.toDate(),{locale:this.$L,utc:!0});return o?Y.add(this.utcOffset(),"minute"):Y},d.local=function(){return y(this.toDate(),{locale:this.$L,utc:!1})};var T=d.parse;d.parse=function(o){o.utc&&(this.$u=!0),this.$utils().u(o.$offset)||(this.$offset=o.$offset),T.call(this,o)};var U=d.init;d.init=function(){if(this.$u){var o=this.$d;this.$y=o.getUTCFullYear(),this.$M=o.getUTCMonth(),this.$D=o.getUTCDate(),this.$W=o.getUTCDay(),this.$H=o.getUTCHours(),this.$m=o.getUTCMinutes(),this.$s=o.getUTCSeconds(),this.$ms=o.getUTCMilliseconds()}else U.call(this)};var m=d.utcOffset;d.utcOffset=function(o,Y){var _=this.$utils().u;if(_(o))return this.$u?0:_(this.$offset)?m.call(this):this.$offset;var w=Math.abs(o)<=16?60*o:o,C=this;if(Y)return C.$offset=w,C.$u=o===0,C;if(o!==0){var L=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(C=this.local().add(w+L,"minute")).$offset=w,C.$x.$localOffset=L}else C=this.utc();return C};var k=d.format;d.format=function(o){return k.call(this,o||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":""))},d.valueOf=function(){var o=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||new Date().getTimezoneOffset());return this.$d.valueOf()-6e4*o},d.isUTC=function(){return!!this.$u},d.toISOString=function(){return this.toDate().toISOString()},d.toString=function(){return this.toDate().toUTCString()};var g=d.toDate;d.toDate=function(o){return o==="s"&&this.$offset?y(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():g.call(this)};var S=d.diff;d.diff=function(o,Y,_){if(o&&this.$u===o.$u)return S.call(this,o,Y,_);var w=this.local(),C=y(o).local();return S.call(w,C,Y,_)}}});const q={dateTimeLocal:"YYYY-MM-DD[T]HH:mm:ss",dateTimeUTC:"YYYYMMDD[T]HHmmss[Z]",allDay:"YYYYMMDD"};function N(l){const t=new URLSearchParams;return Object.keys(l).sort().forEach(c=>{const u=l[c];u!=null&&t.append(c,u)}),t.toString().replace(/\+/g,"%20")}function H({startTime:l,endTime:t},c){const u=q[c];return{start:l.format(u),end:t.format(u)}}I.extend(Q);const E=(l,t=!0)=>{const{start:c,end:u,duration:y}=l,d=function(m,k){if(m==null)return{};var g,S,o={},Y=Object.keys(m);for(S=0;S<Y.length;S++)k.indexOf(g=Y[S])>=0||(o[g]=m[g]);return o}(l,["start","end","duration"]),T=t?I(c).utc():I(c),U=u?t?I(u).utc():I(u):(()=>{if(l.allDay)return T.add(1,"day");if(y&&y.length==2){const m=Number(y[0]);return T.add(m,y[1])}return t?I().utc():I()})();return J({},d,{startTime:T,endTime:U})},K=l=>{const t=E(l),{start:c,end:u}=H(t,t.allDay?"allDay":"dateTimeUTC"),y={action:"TEMPLATE",text:t.title,details:t.description,location:t.location,trp:t.busy,dates:c+"/"+u,recur:t.rRule?"RRULE:"+t.rRule:void 0};return t.guests&&t.guests.length&&(y.add=t.guests.join()),`https://calendar.google.com/calendar/render?${N(y)}`},tt=l=>{const t=E(l,!1),{start:c,end:u}=H(t,"dateTimeLocal");return`https://outlook.live.com/calendar/0/action/compose?${N({path:"/calendar/action/compose",rru:"addevent",startdt:c,enddt:u,subject:t.title,body:t.description,location:t.location,allday:t.allDay||!1})}`},et=l=>{const t=E(l,!1),{start:c,end:u}=H(t,"dateTimeLocal");return`https://outlook.live.com/calendar/0/deeplink/compose?${N({path:"/calendar/action/compose",rru:"addevent",startdt:c,enddt:u,subject:t.title,body:t.description,location:t.location,allday:t.allDay||!1})}`},nt=l=>{const t=E(l,!1),{start:c,end:u}=H(t,"dateTimeLocal");return`https://outlook.office.com/calendar/0/action/compose?${N({path:"/calendar/action/compose",rru:"addevent",startdt:c,enddt:u,subject:t.title,body:t.description,location:t.location,allday:t.allDay||!1})}`},rt=l=>{const t=E(l,!1),{start:c,end:u}=H(t,"dateTimeLocal");return`https://outlook.office.com/calendar/0/deeplink/compose?${N({path:"/calendar/action/compose",rru:"addevent",startdt:c,enddt:u,subject:t.title,body:t.description,location:t.location,allday:t.allDay||!1})}`},at=l=>{const t=E(l),{start:c,end:u}=H(t,t.allDay?"allDay":"dateTimeUTC");return`https://calendar.yahoo.com/?${N({v:60,title:t.title,st:c,et:u,desc:t.description,in_loc:t.location,dur:!!t.allDay&&"allday"})}`},it=l=>{const t=E(l),{start:c,end:u}=H(t,t.allDay?"allDay":"dateTimeUTC");return`https://calendar.aol.com/?${N({v:60,title:t.title,st:c,et:u,desc:t.description,in_loc:t.location,dur:!!t.allDay&&"allday"})}`},st=l=>{const t=E(l),c={subject:t.title,content:t.description,startTime:t.startTime.toISOString(),endTime:t.endTime.toISOString()};return t.guests&&t.guests.length&&(c.attendees=t.guests.join()),`https://teams.microsoft.com/l/meeting/new?${N(c)}`},ot=l=>{const t=E(l),c=(t.description||"").replace(/,/gm,",").replace(/;/gm,";").replace(/\r\n/gm,`
`).replace(/\n/gm,"\\n").replace(/(\\n)[\s\t]+/gm,"\\n"),u=(t.location||"").replace(/,/gm,",").replace(/;/gm,";").replace(/\r\n/gm,`
`).replace(/\n/gm,"\\n").replace(/(\\n)[\s\t]+/gm,"\\n"),{start:y,end:d}=H(t,t.allDay?"allDay":"dateTimeUTC"),T=I(new Date).utc().format(q.dateTimeUTC),U=[{key:"BEGIN",value:"VCALENDAR"},{key:"VERSION",value:"2.0"},{key:"PRODID",value:t.title},{key:"BEGIN",value:"VEVENT"},{key:"URL",value:t.url},{key:"DTSTART",value:y},{key:"DTEND",value:d},{key:"DTSTAMP",value:T},...t.allDay?[{key:"X-MICROSOFT-CDO-ALLDAYEVENT",value:"TRUE"},{key:"X-MICROSOFT-MSNCALENDAR-ALLDAYEVENT",value:"TRUE"}]:[],{key:"RRULE",value:t.rRule},{key:"SUMMARY",value:t.title},{key:"DESCRIPTION",value:c},{key:"LOCATION",value:u},{key:"ORGANIZER",value:t.organizer},{key:"STATUS",value:t.status},{key:"UID",value:Math.floor(1e5*Math.random()).toString().replace(".","")},{key:"END",value:"VEVENT"},{key:"END",value:"VCALENDAR"}];let m="";return U.forEach(k=>{if(k.value)if(k.key=="ORGANIZER"){const g=k.value;m+=`${k.key};${encodeURIComponent(`CN=${g.name}:MAILTO:${g.email}\r
`)}`}else m+=`${k.key}:${encodeURIComponent(`${k.value}\r
`)}`}),`data:text/calendar;charset=utf8,${m}`};export{it as aol,E as eventify,K as google,ot as ics,st as msTeams,nt as office365,rt as office365Mobile,tt as outlook,et as outlookMobile,at as yahoo};
